library(shiny)
library(tidyverse)
library(ggplot2)
ges <- read.csv("GraduateEmploymentSurvey.csv")
ges_clean <- na.omit(ges)
ges_clean$employment_rate_overall <- as.numeric(ges_clean$employment_rate_overall)


nus_years <- c(2014, 2015, 2016, 2017, 2018, 2019, 2020, 2021)
ntu_years <- c(2014, 2015, 2016, 2017, 2018, 2019, 2020, 2021)
smu_years <- c(2014, 2015, 2016, 2017, 2018, 2019, 2020, 2021)
sit_years <- c(2014, 2015, 2016, 2017, 2018, 2019, 2020, 2021)
suss_years <- c(2018, 2019, 2020, 2021)
sutd_years <- c(2015, 2016, 2017, 2018, 2019, 2020, 2021)

head(ges_clean)

ui <- fluidPage(
  titlePanel("Graduate Employment Survey"),
  sidebarLayout(
    position="left",
    headerPanel("Choose your University and Major"),
    sidebarPanel(
      selectInput("university", "Choose a University",
      choices = c("NUS","NTU","SMU","SIT", "SUSS","SUTD")),
      conditionalPanel(
        condition = "input.university == 'NUS'", 
        selectInput("degree", "Choose a Degree",
                    choices = c("Bachelor of Arts","Bachelor of Arts (Hons)","Bachelor of Social Sciences","Bachelor of Business Administration","Bachelor of Business Administration (Hons)"))
      ),
      conditionalPanel(
        condition = "input.university == 'NTU'", 
        selectInput("degree", "Choose a Degree",
                    choices = c("Accountancy and Business","Accountancy (3-yr direct Honours Programme)","Business (3-yr direct Honours Programme)","Business and Computing","Aerospace Engineering"))
      ),
      conditionalPanel(
        condition = "input.university == 'SMU'", 
        selectInput("degree", "Choose a Degree",
                    choices = c("Bachelor of Arts","Bachelor of Arts (Hons)","Bachelor of Social Sciences","Bachelor of Business Administration","Bachelor of Business Administration (Hons)"))
      ),
      selectInput("dataobserved", "Choose a Measurement",
                  choices = c("Overall Employment Rate","Gross Monthly Income")),
    mainPanel(plotOutput("line", width="700")
    )
   )
  )
 )

server <- function(input, output) {
  eventReactive(input$university, {
    switch(input$university,
           "NUS" = "National University of Singapore",
           "NTU" = "Nanyang Technological University",
           "SMU" = "Singapore Management University",
           "SIT" = "Singapore Institute of Technology",
           "SUSS" = "Singapore University of Social Sciences",
           "SUTD" = "Singapore University of Technology and Design")
  }, ignoreNULL = FALSE)
  
  output$line <- renderPlot({
    
    # Placeholder for actual data processing and plotting 
    # Depending on the selected data type, you'll load and plot the appropriate data
    if (input$dataobserved == "Overall Employment Rate") {
      # Placeholder for employment rate data processing and plotting
      # Replace this with actual code to plot employment rate over time
      ggplot(ges_clean, aes(x = year, y = employment_rate_overall)) +
        geom_line() +
        labs(x = "Year", y = "Overall Employment Rate", title = "Overall Employment Rate Over Time")
    } +
      scale_x_continuous(breaks = unique(ges_clean$year))
    else if (input$dataobserved == "Gross Monthly Income") {
      # Placeholder for starting salary data processing and plotting
      # Replace this with actual code to plot starting salary over time
      ggplot(ges_clean, aes(x = year, y = gross_monthly_median)) +
        geom_line() +
        labs(x = "Year", y = "Gross Monthly Income Median", title = "Gross Monthly Income Median Over Time")+
        scale_x_continuous(breaks = unique(ges_clean$year))
    }
  })
}

# Run the application 
shinyApp(ui = ui, server = server)


